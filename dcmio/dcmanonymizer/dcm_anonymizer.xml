<?xml version="1.0" encoding="UTF-8"?>
<pipeline version="1.0">
    <docstring>
        Anonymize DICOM files
        ~~~~~~~~~~~~~~~~~~~~~

        According to PS 3.15-2008, basic application level de-indentification of
        a DICOM file requires replacing the values of a set of data elements and
        the supplement 142 on the clinical trial de-identification profiles. All
        the anonymized fields are replaced and may be set in future into the
        encrypted attributes sequence (0400,0550). In the standard it is not
        required that the Encrypted Attributes Dataset be created; indeed, there
        may be circumstances where the Dataset is expected to be archived long
        enough that any contemporary encryption technology may be inadequate
        to provide long term protection against unauthorized recovery of
        identification.

        The applied de-identification methods are:
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

        * 113100 - Basic Application Confidentiality Profil
        * 113103 - Clean Graphics Option
        * 113109 - Retain Device Identity Option

        To do:
        ~~~~~~

        * 113102 - Clean Recognizable Visual Features Option

        What does this function:
        ~~~~~~~~~~~~~~~~~~~~~~~~

        * All fields specified in the 'deidentify' structure are replaced or
          deleted: to remove all private tags a group 'gggg' has to be
          specified in the structure.
        * All the private tags to keep are specified in the
          'private_deidentify' file. Those fields are necessary to reconstruct
          the image volume properly. 
        * A log is saved with all the anonymization operations.
    </docstring>
    <units>
        <unit name="dcmanon">
            <module>dcmio.dcmanonymizer.dcm_anonymizer_bbox.xml</module>
            <set name="output_directory" value="None"/>
            <iterinput name="inputdir"/>
            <iteroutput name="dcmfiles"/>
            <iteroutput name="logfiles"/>
        </unit>
    </units>
    <links>
        <link source="dcmdirs" destination="dcmanon.iterinputdir"/>
        <link source="dcmanon.iterdcmfiles" destination="dcmfiles"/>
        <link source="dcmanon.iterlogfiles" destination="logfiles"/>
    </links>
    <positions>
        <position unit="inputs" x="-17" y="8"/>
        <position unit="dcmanon" x="237" y="152"/>
        <position unit="outputs" x="595" y="370"/>
    </positions>
    <zoom level="1"/> 
</pipeline>
